---
import { formatBlogPosts, slugify } from "../js/util";

const allPosts = await Astro.glob("../pages/blog/*.md")
const formattedPosts = formatBlogPosts(allPosts)
const allCategories = formattedPosts.map((cat)=> cat.frontmatter.category.toLowerCase())
.flat()

const processedCats = allCategories.reduce((acc, category) => {
    const value = acc[category] || 0
    
    return {
        ...acc,
        [category]: value +1
    }
},{})
const procCats = new Map(Object.entries(processedCats))


const {showCount} = Astro.props
---
<ul class="categories">
{
    procCats.forEach((value, key) => (
        
        <li>
        <a href={`/category/${slugify(key)}`} class="badge"> {key}{showCount &&`(${value})`}</a>    
        </li>
        // ezt meg kell kerdezni discordon
    ))
}
</ul>